= content_for :heading do
  My Profile

= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :multipart => true, :method => :put }) do |f|
  = devise_error_messages!
  %fieldset.registration
    .field
      = f.label :email, 'Email address'
      %br
      = f.text_field :email
    .field
      = f.label :password
      %br
      = f.password_field :password
    .field
      = f.label :password_confirmation
      %br
      = f.password_field :password_confirmation

    - resource.build_user_profile if resource.user_profile.blank?
    = f.fields_for :user_profile do |ff|
      .field
        = ff.label :display_name, "Full Name"
        %br
        = ff.text_field :display_name
      .field
        = ff.label :profile_image
        %br
        = ff.file_field :profile_image
      .field
        = ff.label :dob, 'Date of birth'
        %br
        = ff.text_field :dob
      .field
        = ff.label :dob, 'Sex'
        %br
        = ff.select :sex, ['Male', 'Female']


  #div
    %p Connect with Accounts
    = link_to image_tag('twitter_connect.png',  :alt => "Twitter"), "/auth/twitter", :class => 'auth_provider'
    = link_to image_tag('fb_connect.png',  :alt => "Facebook"), "/auth/facebook", :class => 'auth_provider'
    %br
    -['twitter', 'facebook'].each do |account|
      -unless current_user.instance_eval("#{account}_omniauth").blank?
        = link_to "Remove #{account} account", user_token_path(current_user.instance_eval("#{account}_omniauth")) , :method => :delete, :confirm => "Are you sure?"


    .actions
      = f.submit 'Save'
      \- or -
      = link_to 'Cancel', root_path

